<div class="container">
  <div class="form-card">
    <h2>Add New Employee</h2>

    <form [formGroup]="employeeForm" (ngSubmit)="onSubmit()">
      <!-- Name Field -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Full Name</mat-label>
        <input matInput formControlName="name" placeholder="Enter employee full name">
        <mat-icon matPrefix>person</mat-icon>
        <mat-error *ngIf="employeeForm.get('name')?.hasError('required')">
          Name is required
        </mat-error>
        <mat-error *ngIf="employeeForm.get('name')?.hasError('minlength')">
          Name must be at least 2 characters
        </mat-error>
      </mat-form-field>

      <!-- Email Field -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Email</mat-label>
        <input matInput type="email" formControlName="email" placeholder="Enter employee email">
        <mat-icon matPrefix>email</mat-icon>
        <mat-error *ngIf="employeeForm.get('email')?.hasError('required')">
          Email is required
        </mat-error>
        <mat-error *ngIf="employeeForm.get('email')?.hasError('email') || employeeForm.get('email')?.hasError('pattern')">
          Please enter a valid email (e.g. name@example.com)
        </mat-error>
      </mat-form-field>

      <!-- Job Role Field -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Job Role</mat-label>
        <mat-select formControlName="jobRole">
          <mat-option value="">Select a job role</mat-option>
          <mat-option *ngFor="let jr of jobRoles" [value]="jr">{{ jr }}</mat-option>
        </mat-select>
        <mat-icon matPrefix>work</mat-icon>
        <mat-error *ngIf="employeeForm.get('jobRole')?.hasError('required')">
          Job role is required
        </mat-error>
      </mat-form-field>

      <!-- System Role Field -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>System Role</mat-label>
        <mat-select formControlName="systemRole">
          <mat-option *ngFor="let sr of systemRoles" [value]="sr">{{ sr }}</mat-option>
        </mat-select>
        <mat-icon matPrefix>admin_panel_settings</mat-icon>
        <mat-hint *ngIf="!canEditSystemRole">Only Admin and HR can edit system roles</mat-hint>
        <mat-error *ngIf="employeeForm.get('systemRole')?.hasError('required')">
          System role is required
        </mat-error>
      </mat-form-field>

      <!-- Department Field -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Department</mat-label>
        <mat-select formControlName="departmentId">
          <mat-option [value]="null">-- No Department --</mat-option>
          <mat-option *ngFor="let dept of departments" [value]="dept.departmentId">
            {{ dept.departmentName }}
          </mat-option>
        </mat-select>
        <mat-icon matPrefix>business</mat-icon>
      </mat-form-field>

      <!-- Password Field -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Password</mat-label>
        <input matInput [type]="hidePassword ? 'password' : 'text'" formControlName="password" placeholder="Enter password (min 8 characters)">
        <mat-icon matPrefix>lock</mat-icon>
        <button mat-icon-button matSuffix (click)="hidePassword = !hidePassword" type="button">
          <mat-icon>{{ hidePassword ? 'visibility' : 'visibility_off' }}</mat-icon>
        </button>
        <mat-hint>Password must be at least 8 characters</mat-hint>
        <mat-error *ngIf="employeeForm.get('password')?.hasError('required')">
          Password is required
        </mat-error>
        <mat-error *ngIf="employeeForm.get('password')?.hasError('minlength')">
          Password must be at least 8 characters
        </mat-error>
      </mat-form-field>

      <!-- Confirm Password Field -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Confirm Password</mat-label>
        <input matInput [type]="hideConfirmPassword ? 'password' : 'text'" formControlName="confirmPassword" placeholder="Re-enter password">
        <mat-icon matPrefix>lock</mat-icon>
        <button mat-icon-button matSuffix (click)="hideConfirmPassword = !hideConfirmPassword" type="button">
          <mat-icon>{{ hideConfirmPassword ? 'visibility' : 'visibility_off' }}</mat-icon>
        </button>
        <mat-error *ngIf="employeeForm.get('confirmPassword')?.hasError('required')">
          Please confirm your password
        </mat-error>
        <mat-error *ngIf="employeeForm.hasError('passwordMismatch') && !employeeForm.get('confirmPassword')?.hasError('required')">
          Passwords do not match
        </mat-error>
      </mat-form-field>

      <!-- Buttons -->
      <div class="button-group">
        <button mat-raised-button color="primary" type="submit" [disabled]="employeeForm.invalid || saving">
          <mat-icon>save</mat-icon>
          {{ saving ? 'Saving...' : 'Add Employee' }}
        </button>
        <button mat-stroked-button type="button" (click)="cancel()">
          Cancel
        </button>
      </div>
    </form>
  </div>
</div>
